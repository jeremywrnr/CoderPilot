<!-- code editor layout -->

<template name='code'>
  {{#if nulldoc}}
  {{> loadprompt}}
  {{else}}
  {{> editor }}
  {{/if}}
</template>

<template name='editor'>
  <div class='col-xs-8 editor-container full-height'>
    {{#with docid}}
    {{> filename this}}

    {{#if isImage }}
    {{> renderImage }}

    {{else}} {{#if nullMode }}
    {{> nullFileType }}

    {{else}} <!--if file is in mode whitelist, load-->
    {{> sharejsAce docid=this onRender=config onConnect=setMode id='editor'}}

    {{/if}} {{/if}}
    {{/with}}
  </div>
</template>

<template name='loadprompt'>
  <div class='col-xs-8 full-height'>
    <div class='panel panel-primary'>
      <div class='panel-heading'>
        <h3 class='panel-title'>code editor - let's get started!</h3>
      </div>
      <div class='panel-body'>
        click a file (or make a new one) to start editing your code...
        {{> filelist }} <!--found in file.html-->
        <img class='wide' src='/img/start.gif'/>
      </div>
    </div>
  </div>
</template>

<template name='filename'>
  <div class='navbar navbar-code'>
    <div class='container-fluid'>

      {{#if rename}}
      <form class='navbar-form pull-left rename'>
        <input id='filetitle' class='form-control' type='text' name='title' value='{{title}}'>
      </form>
      {{else}}
      <strong>
        <p class='navbar-text'> ~/{{title}} </p>
      </strong>
      {{/if}}

      <form class='navbar-form pull-right'>
        <button class='edit btn btn-small'>rename</button>
        <button class='del btn btn-small'>delete</button>
      </form>

    </div>
  </div>
</template>

<template name='nullFileType'>
  <div class='panel panel-default'>
    <div class='panel-heading'>
      <h3 class='panel-title'>
        filetype ({{type}}) currently unsupported
      </h3>
    </div>
    <div class='panel-body'>
      view file source on github <a target='_blank' href='{{ source }}'>here</a>
    </div>
  </div>
</template>

<template name='renderImage'>
  <div class='panel panel-default'>
    <div class='panel-heading'>
      <h3 class='panel-title'>
        image rendering
      </h3>
    </div>
    <div class='panel-body'>
      <a target='_blank' href='{{ image }}'>
        <img class='wide' src='{{ image }}'/>
      </a>
    </div>
  </div>
</template>
