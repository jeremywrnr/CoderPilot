<head>
  <title>Code Pilot</title>
</head>

<template name="main">
  <div class="container full-height">
    <div class="col-xs-3 full-height">
      <div class="sidebar">
        <h1><a href="/"> Code Pilot </a></h1>
        {{#if currentUser }}
        {{> navigation }}
        {{/if}}

        {{> loginGithub }}

        {{#if currentUser }}
        {{> filelist }}
        {{> chat }}
        {{/if}}
      </div>
    </div>

    {{> yield}}

  </div>
</template>

<!--login templates-->

<template name="loginGithub">
  <div class="btn-group btn-group-justified" role="group" aria-label="...">
    <div class="btn-group" role="group">
      {{#if currentUser }}
      {{> userLoggedin }}
      {{else}}
      {{> userLoggedout }}
      {{/if}}
    </div>
  </div>
</template>

<template name="userLoggedin">
  {{#if loggingIn }}
  <button type="button" class="btn btn-default">Logging in...</button>
  {{else}}
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">
      {{ currentUser.profile.name }}
      <span class="caret"></span>
    </button>
    <ul class="dropdown-menu">
      <li><a href="/config"> {{currentUser.profile.login }}
          / {{currentUser.profile.role }} </a></li>
      <li class="logout"><a href="#">Log out</a></li>
    </ul>
  </div>
  {{/if}}
</template>

<template name="userLoggedout">
  <button type="button" class="btn btn-default login">Login with Github</button>
</template>

<!-- navigation icons from http://glyphicons.com/ -->

<template name="navigation">
  <div class="btn-group btn-group-justified" role="toolbar">

    {{#each navItems}}
    <a role='button' class='btn btn-primary' href="{{ iconpath }}">
      <span class="glyphicon glyphicon-{{iconname}}" aria-label="{{iconname}}">
      </span>
    </a>
    {{/each}}

  </div>
</template>
