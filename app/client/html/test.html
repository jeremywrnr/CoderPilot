<!--testing stuff here-->

<template name="test">
  <div class="col-xs-8 full-height">
    <h2> testing </h2>
    {{> testtasks }}
    {{> tester}}
  </div>
</template>

<template name="testtasks">
  <div class="panel panel-primary">
    <div class="panel-heading">
      <div class="panel-title">
        tasks ({{incompleteCount}})
      </div>
      <label class="label pull-right"> hide complete
        <input type="checkbox" checked="{{hideCompleted}}" class="hide-completed"/>
      </label>
    </div>
    <div class="panel-body">
      <form class="new-task">
        <input type="text" class="form-control" placeholder="add a task..." />
      </form>
      <ul class="list-group">
        {{#each tasks}}
        {{> todotask}}
        {{/each}}
      </ul>
    </div>
  </div>
</template>

<template name="todotask">
  <li class="list-group-item toggle-checked {{#if checked}}checked disabled{{/if}}">
    <input type="checkbox" class="toggle-checked" checked="{{checked}}"> {{text}}
    <button class="pull-right label btn del">&times;</button>
    <button class="pull-right label btn btn-info">{{username}}</button>
  </li>
</template>

<template name="tester">
  <div class="panel panel-primary">
    <div class="panel-heading">
      <div class="panel-title"> tester </div>
    </div>
    <div class="panel-body"> {{> iframe}} </div>
  </div>
</template>

<template name="iframe"><!--lol all the hackery...-->
  <div style="margin:0px;padding:0px;overflow:hidden">
    <iframe srcdoc='
      <html>
        <head>

          <style type="text/css"> {{getCSS}} </style>

          <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>

          <script type="text/javascript">
          $(document).ready(function(){ {{getJS}} });
          </script>

          <script type="text/javascript">
          // overwrite local console.log for iframe
          (function () {
          var old = console.log;
          var logger = $("#log");
          console.log = function (message)
          {
          if (typeof message == "object") {
          logger.innerHTML += (JSON && JSON.stringify ? JSON.stringify(message) : message) + "<br />";
          } else {
          logger.innerHTML += message + "<br />";}
          }
          })();
          </script>

        </head>
        <body>

          <div id="log"></div> {{ getHTML }}

        </body>
      </html>
      ' style="overflow:hidden;height:100%;width:100%"
        frameborder="0" height="100%" width="100%">
    </iframe>
  </div>
</template>
