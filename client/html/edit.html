<!-- code editor layout -->

<template name="code">
  {{#if nulldoc}}
  {{> loadprompt}}
  {{else}}
  {{> editor }}
  {{/if}}
</template>

<template name="editor">
  {{#with docid}}
  {{> filename this}}

  {{#if isImage }}
  {{> renderImage this}}

  {{else}}
  <div id="editor-container"> <div id="editor"></div> </div>
  <script>
      //// Initialize Firebase.
      var docRef = (Session.get("fb") + "{{docid}}" );
      var firepadRef = new Firebase(docRef);

      //// Create ACE
      var editor = ace.edit("editor");
      editor.setTheme("ace/theme/monokai");
      var session = editor.getSession();
      session.setUseWrapMode(true);
      session.setUseWorker(false);
      session.setMode("ace/mode/javascript");

      //// Create Firepad.
      var firepad = Firepad.fromACE(firepadRef, editor, {});
  </script>

  {{/if}}
  {{/with}}
</template>

<template name="loadprompt">
  <div id="mainhead">
    <p class="navbar-text"> editor </p> </div>

  <div class="alert alert-success alert-dismissable" role="alert">
    First time here? <a class="alert-link" href="/config"> [click here to set up your account] </a> </div>
  <div class="alert alert-info" role="alert">
    Let's get started - click a file to start editing code! </div>

  <ul class="nav nav-pills nav-stacked">
    {{> userfiles}} </ul> <!-- file.html-->
</template>

<template name="filename">
  <div id="editor-head">
    {{#if rename}}
    <form class="navbar-form pull-left rename">
      <input id="filetitle" class="form-control" type="text" name="title" value="{{title}}"> </form>
    <form class="navbar-form pull-right">
      <button class="grn btn btn-default btn-small">cancel</button> </form>
    {{else}}

    <p class="navbar-text"> ~/{{title}} </p>
    <form class="navbar-form pull-right">
      <a href="/test"><button class="grn btn btn-default btn-small">test</button></a>
      <a href="/save"><button class="grn btn btn-default btn-small">save</button></a>
      <button class="edit btn btn-default btn-small">rename</button>
      <button class="del btn btn-default btn-small">delete</button> </form>
    {{/if}}
  </div>
</template>

