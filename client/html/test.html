<!-- testing -->

<template name="test">
  {{> testviz}}
  {{> testweb}}
  {{> issues}}
</template>

<template name="testviz">
  <div id="mainhead">
    <p class="navbar-text"> visualize </p>
    <form class="navbar-form pull-right">
      {{#if enabled }}
      <a href="/code"><button class="grn btn btn-default btn-small">code</button></a>
      <a href="/save"><button class="grn btn btn-default btn-small">save</button></a>
      <button class="grn btn btn-default btn-small reload">reload</button>
      <button class="edit btn btn-default btn-small target">target</button>
      {{/if}}
      <button class="edit btn btn-default btn-small toggle">toggle</button>
    </form>
  </div>

  {{#if enabled }}
  {{#if target }}
  {{> testfile }}
  {{else}}
  {{#if file }}
  {{#if lang }}
  <div class="resize">
    <!--<iframe src="http://pythontutor.com/live.html#code={{testcode}}&origin=opt-frontend.js&cumulative=false&heapPrimitives=false&textReferences=false&py={{lang}}&rawInputLstJSON=%5B%5D&curInstr=0&codeDivWidth=50%25&codeDivHeight=400"-->
    <iframe src="http://pythontutor.com/iframe-embed.html#code={{testcode}}&origin=opt-frontend.js&cumulative=false&heapPrimitives=false&textReferences=false&py={{lang}}&rawInputLstJSON=%5B%5D&curInstr=0&codeDivWidth=50%25&codeDivHeight=400"
            sandbox="allow-scripts allow-same-origin"
            frameborder="0" id="testviz" width="100%" height="100%"></iframe>
  </div>
  {{else}}
  <div class="alert alert-info" role="alert">
    File (<i>{{ title }}</i>) with type (<i>{{ mode }}</i>) currently has no <a class="alert-link"
                                                                                href="http://pythontutor.com/" target="_blank">PythonTutor</a> support. </div>
  {{/if}}
  {{else}}
  <div class="alert alert-info" role="alert">
    <a href="#" class="alert-link target">Select a target file</a> to run and visualize with <a class="alert-link" href="http://pythontutor.com/" target="_blank">PythonTutor!</a> </div>
  {{/if}}
  {{/if}}
  {{/if}}
</template>

<template name="testfile">
  <ul class="nav nav-pills nav-stacked sidelist">
    {{#if files.count}}
    {{#each files}}
    <li class="file {{#if current}}active{{/if}}">
      <a href="#">
        {{#if current}}
        <span class="glyphicon glyphicon-asterisk"></span>
        {{/if}}
        {{title}} </a> </li>
    {{/each}}
    {{else}}
    <li class="file new"> <a href="#"> no files yet </a> </li>
    {{/if}}
  </ul>
</template>

<template name="testweb">
  <div id="mainhead">
    <p class="navbar-text"> render </p>
    <form class="navbar-form pull-right">
      {{#if enabled }}
      <a href="/code"><button class="grn btn btn-default btn-small">code</button></a>
      <a href="/save"><button class="grn btn btn-default btn-small">save</button></a>
      <a href="/renderer"><button class="grn btn btn-default btn-small">full</button></a>
      <button class="grn btn btn-default btn-small reload">reload</button>
      {{/if}}
      <button class="edit btn btn-default btn-small toggle">toggle</button>
    </form>
  </div>

  {{#if enabled }}
  <div class="resize">
    <iframe id="testweb" src="/raw" frameborder="0" height="100%" width="100%"></iframe>
  </div>
  {{/if}}
</template>



<!-- github issue integration -->

<template name="issues">
  <div class="header">
    <p class="navbar-text"> issues ({{issueCount}}) </p>
    <form class="navbar-form pull-right">
      <button class="grn btn btn-default pull-right reload"> reload </button>
    </form>
  </div>

  <ul class="list-group nomargin">
    {{#if issueCount}}
    {{#each issues }}
    {{> issue }}
    {{/each}}
    {{else}}
    <button class="list-group-item issue"> no issues yet. </button>
    {{/if}}
  </ul>
</template>

<template name="issue">
  <button class="list-group-item issue" id="{{#if current }}active-issue{{/if}}">
    {{ issue.title }}
    {{#each labels }}
    {{> issueLabel }}
    {{/each}}
  </button>

  {{#if current}}
  <button class="list-group-item" href="#">
    <div class="btn-group btn-group-justified nomargin">
      <a role="button" target="_blank" class="btn btn-default grn" href="{{ issue.html_url }}">
        view github issue </a>
      <a role="button" class="btn btn-default del closeissue" href="#">
        close issue </a>
    </div>
    <a target="_blank" href="/screenshot/{{ feedback.imglink }}">
      <img style="width: 100%;" src="{{ screen }}" />
    </a>
  </button>
  {{/if}}

</template>

<template name="issueLabel">
  <span class="pull-right label label-default" style="background: #{{color}};"> {{ name }} </span>
</template>

